apiVersion: v1
data:
  fields.yml: |
    - key: ecs
      title: ECS
      description: ECS Fields.
      fields:
      - name: '@timestamp'
        level: core
        required: true
        type: date
        description: 'Date/time when the event originated.
    
          This is the date/time extracted from the event, typically representing when
          the event was generated by the source.
    
          If the event source has no original timestamp, this value is typically populated
          by the first time the event was received by the pipeline.
    
          Required field for all events.'
        example: '2016-05-23T08:05:34.853Z'
      - name: labels
        level: core
        type: object
        object_type: keyword
        description: 'Custom key/value pairs.
    
          Can be used to add meta information to events. Should not contain nested objects.
          All values are stored as keyword.
    
          Example: `docker` and `k8s` labels.'
        example: '{"application": "foo-bar", "env": "production"}'
      - name: message
        level: core
        type: text
        description: 'For log events the message field contains the log message, optimized
          for viewing in a log viewer.
    
          For structured logs without an original message field, other fields can be concatenated
          to form a human-readable summary of the event.
    
          If multiple messages exist, they can be combined into one message.'
        example: Hello World
      - name: tags
        level: core
        type: keyword
        ignore_above: 1024
        description: List of keywords used to tag each event.
        example: '["production", "env2"]'
      - name: agent
        title: Agent
        group: 2
        description: 'The agent fields contain the data about the software entity, if
          any, that collects, detects, or observes events on a host, or takes measurements
          on a host.
    
          Examples include Beats. Agents may also run on observers. ECS agent.* fields
          shall be populated with details of the agent running on the host or observer
          where the event happened or the measurement was taken.'
        footnote: 'Examples: In the case of Beats for logs, the agent.name is filebeat.
          For APM, it is the agent running in the app/service. The agent information does
          not change if data is sent through queuing systems like Kafka, Redis, or processing
          systems such as Logstash or APM Server.'
        type: group
        fields:
        - name: build.original
          level: core
          type: keyword
          ignore_above: 1024
          description: 'Extended build information for the agent.
    
            This field is intended to contain any build information that a data source
            may provide, no specific formatting is required.'
          example: metricbeat version 7.6.0 (amd64), libbeat 7.6.0 [6a23e8f8f30f5001ba344e4e54d8d9cb82cb107c
            built 2020-02-05 23:10:10 +0000 UTC]
          default_field: false
        - name: ephemeral_id
          level: extended
          type: keyword
          ignore_above: 1024
          description: 'Ephemeral identifier of this agent (if one exists).
    
            This id normally changes across restarts, but `agent.id` does not.'
          example: 8a4f500f
        - name: id
          level: core
          type: keyword
          ignore_above: 1024
          description: 'Unique identifier of this agent (if one exists).
    
            Example: For Beats this would be beat.id.'
          example: 8a4f500d
        - name: name
          level: core
          type: keyword
          ignore_above: 1024
          description: 'Custom name of the agent.
    
            This is a name that can be given to an agent. This can be helpful if for example
            two Filebeat instances are running on the same host but a human readable separation
            is needed on which Filebeat instance data is coming from.
    
            If no name is given, the name is often left empty.'
          example: foo
        - name: type
          level: core
          type: keyword
          ignore_above: 1024
          description: 'Type of the agent.
    
            The agent type always stays the same and should be given by the agent used.
            In case of Filebeat the agent would always be Filebeat also if two Filebeat
            instances are run on the same machine.'
          example: filebeat
        - name: version
          level: core
          type: keyword
          ignore_above: 1024
          description: Version of the agent.
          example: 6.0.0-rc2
    - key: beat
      anchor: beat-common
      title: Beat
      description: >
        Contains common beat fields available in all event types.
      fields:
        - name: agent.hostname
          type: keyword
          description: >
            Deprecated - use agent.name or agent.id to identify an agent.
            Hostname of the agent.
    
        - name: beat.timezone
          type: alias
          path: event.timezone
          migration: true
    
        - name: fields
          type: object
          object_type: keyword
          description: >
            Contains user configurable fields.
    
        - name: beat.name
          type: alias
          path: host.name
          migration: true
    
        - name: beat.hostname
          type: alias
          path: agent.hostname
          migration: true
    
        - name: timeseries.instance
          type: keyword
          description: Time series instance id
    - key: docker
      title: Docker
      description: >
        Docker stats collected from Docker.
      short_config: false
      anchor: docker-processor
      fields:
        - name: docker
          type: group
          fields:
            - name: container.id
              type: alias
              path: container.id
              migration: true
    
            - name: container.image
              type: alias
              path: container.image.name
              migration: true
    
            - name: container.name
              type: alias
              path: container.name
              migration: true
    
            - name: container.labels  # TODO: How to map these?
              type: object
              object_type: keyword
              description: >
                Image labels.
    - key: host
      title: Host
      description: >
        Info collected for the host machine.
      anchor: host-processor
      fields:
    
        # ECS fields are in fields.ecs.yml.
        # These are the non-ECS fields.
        - name: host
          type: group
          fields:
    
            - name: containerized
              type: boolean
              description: >
                If the host is a container.
    
            - name: os.build
              type: keyword
              example: "18D109"
              description: >
                OS build information.
    
            - name: os.codename
              type: keyword
              example: "stretch"
              description: >
                OS codename, if any.
    - key: kubernetes
      title: Kubernetes
      description: >
        Kubernetes metadata added by the kubernetes processor
      short_config: false
      anchor: kubernetes-processor
      fields:
        - name: kubernetes
          type: group
          fields:
            - name: pod.name
              type: keyword
              description: >
                Kubernetes pod name
    
            - name: pod.uid
              type: keyword
              description: >
                Kubernetes Pod UID
    
            - name: namespace
              type: keyword
              description: >
                Kubernetes namespace
    
            - name: node.name
              type: keyword
              description: >
                Kubernetes node name
    
            - name: labels.*
              type: object
              object_type: keyword
              object_type_mapping_type: "*"
              description: >
                Kubernetes labels map
    
            - name: annotations.*
              type: object
              object_type: keyword
              object_type_mapping_type: "*"
              description: >
                Kubernetes annotations map
    
            - name: replicaset.name
              type: keyword
              description: >
                Kubernetes replicaset name
    
            - name: deployment.name
              type: keyword
              description: >
                Kubernetes deployment name
    
            - name: statefulset.name
              type: keyword
              description: >
                Kubernetes statefulset name
    
            - name: container.name
              type: keyword
              description: >
                Kubernetes container name
    
            - name: container.image
              type: keyword
              description: >
                Kubernetes container image

kind: ConfigMap
metadata:
  labels:
    app: filebeat-filebeat
  name: filebeat-fields-config
  namespace: logging

