apiVersion: v1
data:
  filebeat.yml: |
    filebeat.inputs:
    - type: container
      tail_files: true
      paths:
        - /var/log/containers/dev-glib-eql-engine*_g_*.log
      multiline.type: pattern
      multiline.pattern: '^\d{4}-\d{2}-\d{2}'
      multiline.negate: true
      multiline.match: after
      processors:
      - add_kubernetes_metadata:
         in_cluster: true
         matchers:
          - logs_path:
              logs_path: "/var/log/containers/"
      - drop_event:
          when:
            not: 
             equals:
               kubernetes.labels.app: glib-eql-engine-2-0 
    output.logstash:
      hosts: ["logstash-logstash:5044"]
kind: ConfigMap
metadata:
  labels:
    app: filebeat-filebeat
  name: filebeat-filebeat-config
  namespace: logging

